name: improved2d_raw_sweep
method: bayes
metric:
  name: val/final_f1
  goal: maximize
run_cap: 50

parameters:
  learning_rate:
    min: 1.0e-5
    max: 5.0e-4

  dropout_rate:
    min: 0.2
    max: 0.7

  batch_size:
    value: 32

  # Architecture options
  n_filters:
    value: "16_32_64"

  kernel_sizes:
    values:
      # Temporal-focused architectures (faster)
      - "100_2__25_4__10_2"     # ~Final: (450, 16) - balanced temporal
      - "75_3__20_6__8_3"       # ~Final: (450, 11) - broader spatial
      - "120_1__30_2__12_2"     # ~Final: (440, 17) - pure temporal first
      
      # Your proven architecture
      - "150_2__20_17__20_2"    # Your current working one
      
      # Spatial-temporal hybrids (moderate complexity)
      - "80_4__25_8__10_4"      # ~Final: (400, 8) - square-ish kernels
      - "60_6__15_10__8_4"      # ~Final: (450, 6) - progressive spatial
      
      # Conservative options (fastest)
      - "50_2__15_4__8_2"       # ~Final: (470, 16) - small kernels
      - "40_3__12_6__6_3"       # ~Final: (480, 11) - very conservative

  strides:
    values:
      - "2_2__2_2__1_1"        # uniform early reduction
      - "2_1__2_1__2_1"        # temporal focus
      - "1_2__2_1__1_1"        # spatial then temporal
      - "3_1__2_1__1_1"        # aggressive temporal start
      - "2_1__2_2__2_1"        # late reduction

  padding_sizes:
    values:
      - "0_0__0_0__0_0"        # no padding - natural reduction
      - "1_1__1_1__1_1"        # minimal uniform padding
      - "2_1__1_1__1_1"        # light temporal padding
      - "5_1__2_1__1_1"        # moderate padding
      - "10_1__3_2__2_1"       # heavier padding for larger kernels

  max_epochs:
    value: 50

  patience:
    value: 5

  min_delta:
    value: 0.001

  normalize:
    values:
      # - sample-channel
      # - sample
      - channel-subject
      # - subject
      # - channel
      # - full

  pos_weight:
    value: 0.7

  early_stopping_metric:
    values:
      - loss
      # - f1
      # - mcc

program: experiments.AD_vs_HC.combined.raw.sweep

command:
  - ${env}
  - uv
  - run
  - -m
  - ${program}
  - Improved2D
  - ${args}

